{% extends 'parent.html' %}

{% block content %}
<title>Book ID:{{ book.pk }}</title>
<br/>
    <div class="card" style="width: 45rem;">
    <div class="card-header">
        <strong class="card-title"> {{ book.title }} by {{ book.get_many_string.authors }}</strong>
        <br/>
        <small class="card-text">Published in {{ book.publishing_date }} </small>
    </div>
        <div class="card-body">
            {% if average_rating %}
            Rating: {{ average_rating }}<br/>
            {% endif %}
            <strong>Description:</strong><br/>
            {{ book.description }}</p>
            <a href="{% url 'library:pdf_page' book_pk=book.pk page_number=1 %}" class="btn btn-outline-primary">Read</a>
            {% if user.is_authenticated %}
                {% if review %}
                    <a> Already reviewed </a>
                {% else %}
                    <a href="{% url 'library:leave_review' book_pk=book.pk %}" class="btn btn-outline-primary">Leave a review</a>
                {% endif %}
            {% else %}
            <a href="{% url 'user:login' %}" class="btn btn-outline-primary">Login</a>
            {% endif %}
            <a href="{% url 'library:books' %}" class="btn btn-outline-primary">Back to list</a>
        </div>
    </div>
<br/>
    <div class="card-header">
            <strong class="card-title">Reviews:</strong>
        </div>
        <div class="card-body">
            {% for review in book.reviews.all %}
                <div class="card">
                    <div class="card-header">
                        <strong class="card-text">{{ review.user.username }}</strong><br/>
                        <small class="card-text">{{ review.created_at }}</small>
                    </div>
                    <div class="card-body">
                        <em> "{{ review.subject }}"</em><br/>
                        <i class="card-text">{{ review.text }}</i>
                    </div>
                </div>
            {% empty %}
                <p>No reviews yet.</p>
            {% endfor %}
        </div>
    </div>
{% endblock %}
